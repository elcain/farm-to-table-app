// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section hidden" data-dojo-attach-point\x3d"filteredMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section hidden" data-dojo-attach-point\x3d"searchNoneTipSection"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),function(t,u,v,w,x,y,g,z,b,C,f,p,q,r,A,D,B){return t([u,v,w,y],{templateString:x,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,
originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=B},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=A.getStandardPortalUrl(this.portalUrl));this.own(p(this.allMapsTableDiv,"scroll",g.hitch(this,this._onAllMapsSectionScroll)));this.own(p(this.filteredMapsTableDiv,"scroll",g.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){b.removeClass(this.domNode,
"hidden")},hide:function(){b.addClass(this.domNode,"hidden")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=g.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),r.getPortal(this.portalUrl).queryItems(this.query).then(g.hitch(this,function(a){this.domNode&&(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),g.hitch(this,function(a){console.error(a);
this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=g.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),r.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(g.hitch(this,function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,
this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),g.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(b.removeClass(this.filteredMapsTableDiv,"hidden"),b.addClass(this.searchNoneTipSection,"hidden")):(b.addClass(this.filteredMapsTableDiv,"hidden"),b.removeClass(this.searchNoneTipSection,"hidden"))},clear:function(){this.clearAllMapsSection();
this.clearFilteredMapsSection()},clearAllMapsSection:function(){b.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){b.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){b.removeClass(this.allMapsSection,"hidden");b.addClass(this.filteredMapsSection,"hidden")},showFilterMapsSection:function(a){this._showFilterMapsSection();a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){b.addClass(this.allMapsSection,
"hidden");b.removeClass(this.filteredMapsSection,"hidden");b.removeClass(this.filteredMapsTableDiv,"hidden");b.addClass(this.searchNoneTipSection,"hidden")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return q.isScrollToBottom(a)},_createMapItems:function(a,c){a=z.filter(a.results,g.hitch(this,
function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==a.length){var l={},d,h=f("td.empty",c),e;if(0<h.length){var m=Math.min(a.length,h.length),k=a.splice(0,m);for(e=0;e<m;e++){var n=h[e];d=this._createMapItem(k[e]);l[d.item.id]=d;b.place(d,n);b.removeClass(n,"empty")}}if(0!==a.length){h=Math.ceil(a.length/5);for(e=0;e<h;e++)for(d=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),b.place(d,
c),m=f("td",d),k=0;k<m.length;k++)n=m[k],(d=a[5*e+k])?(d=this._createMapItem(d),l[d.item.id]=d,b.place(d,n)):b.addClass(n,"empty");!this.getSelectedMapItem()&&this.appConfig&&this.appConfig.map.itemId&&(d=l[this.appConfig.itemId])&&(c=f(".map-item-bg",d),b.addClass(c,"selected"))}}},_getWebMapCount:function(a){return f(".map-item-div",a).length},_createMapItem:function(a){var c=b.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
l=f(".map-item-bg",c)[0],d=f(".map-item-thumbnail",c)[0],h=f(".map-item-title",c)[0],e=f(".map-item-detail-icon",c)[0];f(".none-thumbnail-tip",c);e.href=a.detailsPageUrl;e.title=this.nls.viewItemDetails||"";c.item=a;e=a.thumbnailUrl||q.getDefaultWebMapThumbnail();b.setStyle(d,"backgroundImage","url("+e+")");this.own(p(l,"click",g.hitch(this,this._onMapItemBgClick)));h.innerHTML=a.title;h.title=a.title;return c},unselect:function(){f(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var c=null;b.hasClass(a,"map-item-thumbnail")?c=a.parentNode:b.hasClass(a,"none-thumbnail-tip")&&(c=a.parentNode.parentNode);c&&b.hasClass(c,"map-item-bg")&&(this.unselect(),b.addClass(c,"selected"),this.emit("select",{mapTable:this,selectedNode:c}))},getSelectedMapItem:function(){var a=null,b=f(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})});